# Scanner UX Flow - Inline Camera

## âœ… Flow: Stays on Same Page (No Redirect)

The scanner uses **inline camera view** - everything happens on the same page without redirects.

---

## ğŸ“± User Experience Flow

### Option 1: Voice Activation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Payment Scanner Page               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ™ï¸ Voice Control              â”‚  â”‚
â”‚  â”‚ Say: "Hey Ongea" then...      â”‚  â”‚
â”‚  â”‚           [ğŸ¤ Mic Button]      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [Quick Start Auto-Scanner]         â”‚
â”‚  [Scan Mode Options]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (User says "Hey Ongea")
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŸ¢ VOICE ACTIVATED                 â”‚
â”‚  Hearing: "scan till"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (Camera opens inline)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¹ LIVE CAMERA VIEW                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â”‚    [Live Camera Feed]         â”‚  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  ğŸ¤– AI Auto-Detection Active        â”‚
â”‚  ğŸ”Š "Point at any payment document" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (AI detects payment)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… DETECTED!                       â”‚
â”‚  ğŸ“„ Till: 832909                    â”‚
â”‚  ğŸ’° Amount: KSh 1,200               â”‚
â”‚  ğŸ’³ M-Pesa fee: KSh 15              â”‚
â”‚  ğŸ¢ Ongea Pesa: KSh 6               â”‚
â”‚  ğŸ’µ Total: KSh 1,221                â”‚
â”‚  [âœ“ Proceed]  [âœ— Cancel]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option 2: Button Click

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Payment Scanner Page               â”‚
â”‚  [ğŸ™ï¸ Voice Control]                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“· Start Auto-Scanning        â”‚  â”‚  â† User clicks
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Or choose mode:                    â”‚
â”‚  [Paybill] [Till] [QR] [Receipt]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (Same page, camera opens)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¹ LIVE CAMERA VIEW (Inline)       â”‚
â”‚  [â† Back] AI Processing...          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    ğŸ¥                          â”‚  â”‚
â”‚  â”‚  LIVE CAMERA FEED              â”‚  â”‚
â”‚  â”‚    Point at document           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  ğŸ¤– Auto-scanning every 2 seconds   â”‚
â”‚  [ğŸ”Š Audio ON] [ğŸ¤– Auto-Scan ON]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (AI extracts details)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… SUCCESS!                        â”‚
â”‚  Voice AI speaks:                   â”‚
â”‚  ğŸ”Š "Till number detected! 832909   â”‚
â”‚      Amount KSh 1200. M-Pesa fee    â”‚
â”‚      KSh 15. Ongea Pesa fee KSh 6.  â”‚
â”‚      Total KSh 1221. Your balance   â”‚
â”‚      is KSh 15,000. Proceed?"       â”‚
â”‚  [âœ“ Proceed to Pay] [âœ— Cancel]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key UX Features

### 1. **No Page Redirects**
- âœ… Camera opens **inline** on same page
- âœ… Smooth transition (no loading/flickering)
- âœ… Back button closes camera, returns to scanner page

### 2. **Real-time Visual Feedback**
- ğŸŸ¢ Green border when voice activated
- ğŸ”´ Red pulsing mic when listening
- ğŸ“Š Live transcript display
- âš¡ Processing indicator during AI analysis

### 3. **Auto-Scan Mode (Default)**
- ğŸ¤– Continuously scans every 2 seconds
- âœ… No need to press capture button
- ğŸ¯ Just point and wait
- ğŸ”Š Audio feedback when detected

### 4. **Voice Integration**
- ğŸ™ï¸ Always listening for "Hey Ongea"
- ğŸ’¬ Real-time transcript showing what it hears
- âœ… Confirmed commands shown in green
- ğŸ”Š Voice speaks fees and details

---

## ğŸ“ Layout States

### State 1: Initial Scanner Page
```
+-----------------------------------+
|  â† Payment Scanner                |
|  Scan bills, receipts & codes     |
+-----------------------------------+
| ğŸ™ï¸ Voice Control     [ğŸ¤]        |
| Say: "Hey Ongea" then...          |
+-----------------------------------+
| ğŸ“· Quick Start Auto-Scanner       |
| [Start Auto-Scanning]             |
+-----------------------------------+
| Or choose mode:                   |
| [Paybill] [Till] [QR] [Receipt]   |
| [Bank]    [Pochi]                 |
+-----------------------------------+
```

### State 2: Camera View (Inline)
```
+-----------------------------------+
| â† AI Processing...                |
| ğŸ¤– Auto-Scanning Active           |
+-----------------------------------+
|                                   |
|      ğŸ“¹ LIVE CAMERA FEED          |
|                                   |
|   (Full width video element)      |
|                                   |
+-----------------------------------+
| ğŸ¤– AI Auto-Detection Active       |
| Point at any payment document     |
+-----------------------------------+
| [ğŸ”Š Audio ON] [ğŸ¤– Auto-Scan ON]   |
+-----------------------------------+
```

### State 3: Result Display (After Detection)
```
+-----------------------------------+
| â† Payment Scanner                 |
+-----------------------------------+
| âœ… Till Number Detected           |
|                                   |
| ğŸ“„ Till: 832909                   |
| ğŸª Merchant: SuperMart            |
| ğŸ’° Amount: KSh 1,200              |
|                                   |
| Fee Breakdown:                    |
| ğŸ’³ M-Pesa: KSh 15                 |
| ğŸ¢ Ongea Pesa: KSh 6              |
| ğŸ’µ Total: KSh 1,221               |
|                                   |
| ğŸ’¼ Your Balance: KSh 15,000       |
| ğŸ“Š Confidence: 98%                |
|                                   |
| [âœ“ Proceed to Pay] [âœ— Cancel]    |
+-----------------------------------+
```

---

## ğŸ”„ State Management

### Component State:
```typescript
isScanning = false    // Initial: show scanner options
isScanning = true     // Camera view (inline)
scanResult = data     // Show result, hide camera
```

### Rendering Logic:
```typescript
if (scanResult) {
  // Show detection result
  return <ScanResult />
}

if (isScanning) {
  // Show inline camera view
  return <CameraView />
}

// Show scanner options (default)
return <ScannerOptions />
```

---

## ğŸ¨ Visual Indicators

### Voice States:
- **Listening**: Green "Listening" badge
- **Activated**: Pulsing green "Active" badge + green card border
- **Hearing**: Blue box with interim transcript
- **Command**: Green box with confirmed command

### Camera States:
- **Idle**: Ready to scan
- **Processing**: "AI Processing..." with spinner
- **Detected**: Auto-transition to result

### Audio Feedback:
- ğŸ”Š "Starting till scan"
- ğŸ”Š "Till detected! Number 832909..."
- ğŸ”Š "M-Pesa fee 15 shillings..."
- ğŸ”Š "Total cost 1221 shillings"

---

## âš¡ Performance

### Smooth Transitions:
- Camera opens in < 500ms
- AI processing: 2-3 seconds
- Voice response: Instant
- No page reloads or redirects

### Optimizations:
- Camera stream reused (not recreated)
- Auto-scan throttled to 2 seconds
- Voice recognition continuous (no restarts)
- Minimal re-renders

---

## ğŸ§ª Test the Flow

### Test 1: Voice Activation
1. Open scanner
2. Click green mic button (starts listening)
3. Say: "Hey Ongea"
4. See: Green "Active" badge appears
5. Say: "Scan till"
6. See: Camera opens inline
7. Point at document
8. Hear: AI speaks detection

### Test 2: Button Click
1. Open scanner
2. Click "Start Auto-Scanning"
3. See: Camera opens inline (same page)
4. Point at document
5. Wait: 2-3 seconds
6. Hear: AI speaks result
7. See: Result card replaces camera

### Test 3: Specific Mode
1. Click "Till Numbers" card
2. Camera opens for till scanning
3. Auto-detects till format
4. Shows result with fees

---

## âœ… Summary

**The scanner stays on ONE page throughout:**

1. **Initial view**: Scanner options + voice control
2. **Camera view**: Inline camera (replaces options)
3. **Result view**: Detection result (replaces camera)
4. **Back button**: Returns to initial view

**No redirects. No new pages. Just smooth inline transitions.** ğŸš€
